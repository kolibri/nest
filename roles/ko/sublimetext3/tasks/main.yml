---
- name: get sublimetext3 key content
  uri:
    url: "https://download.sublimetext.com/sublimehq-pub.gpg"
    dest: /tmp/sublimehq-pub.gpg
    timeout: 6
  register: sublimetext3_pacman_key

# Install the GPG key:
- name: ensure sublimetext3 pacman keys
  become: true
  shell: pacman-key --add /tmp/sublimehq-pub.gpg  && pacman-key --lsign-key 8A8F901A


# curl -O https://download.sublimetext.com/sublimehq-pub.gpg &&
#   sudo pacman-key --add sublimehq-pub.gpg &&
#   sudo pacman-key --lsign-key 8A8F901A &&
#   rm sublimehq-pub.gpg


# Select the channel to use:

- name: sublimetext3 pacman channel
  become: true
  ini_file:
    dest:    /etc/pacman.conf
    section: sublime-text
    option:  Server
    value:   https://download.sublimetext.com/arch/stable/x86_64
  register: sublimetext3_update_pacman
#echo -e "\n[sublime-text]\nServer = https://download.sublimetext.com/arch/stable/x86_64" | sudo tee -a /etc/pacman.conf


# Update pacman and install Sublime Text
- name: sublimetext3 is installed
  become: true
  package:
    # update_cache: yes
    # upgrade: yes
    state: latest
    name:
      - sublime-text


#sudo pacman -Syu sublime-text



# - name: sublimetext3 is installed
#   include_role:
#     name: ko/aur
#   vars:
#     pkg_name: sublime-text-dev
